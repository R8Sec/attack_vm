---
- name: Create Temporary Directory
  tempfile:
    state: directory
  register: temp_dir

- name: Download font zip file and save to temporary directory
  get_url:
    url: "{{ font_zip_url }}"
    dest: "{{ temp_dir.path }}/{{ font_zip_url | basename }}"
    mode: 0755 

- name: Ensure ~/.local/share/fonts Directory Exists
  file:
    path: "~/.local/share/fonts"
    state: directory
    mode: 0755

- name: Unzip font files to ~/.local/share/fonts
  unarchive:
    src: "{{ temp_dir.path }}/{{ font_zip_url | basename }}"
    dest: "~/.local/share/fonts"
    
- name: Ensure ~/.config/terminator Directory Exists
  file:
    path: "~/.config/terminator"
    state: directory
    mode: 0755

- name: Copy Terminator config file, overwrite if needed
  copy:
    src: "terminator_config"
    dest: "~/.config/terminator/config"
    force: yes

- name: Copy .zshrc file, overwrite if needed
  copy:
    src: ".zshrc"
    dest: "~/.zshrc"
    force: yes

- name: Delete Temporary Directory
  file:
    path: "{{ temp_dir.path }}"
    state: absent

- name: Check if Powerlevel10k repository exists
  stat:
    path: "~/.powerlevel10k"
  register: powerlevel10k_repo
  
- name: Clone Powerlevel10k repository
  command: "git clone --depth=1 https://github.com/romkatv/powerlevel10k.git ~/.powerlevel10k"
  when: powerlevel10k_repo.stat.exists == False

- name: Edit .zshrc file
  lineinfile:
    path: "~/.zshrc"
    line: "source ~/.powerlevel10k/powerlevel10k.zsh-theme"
    insertafter: EOF
    state: present